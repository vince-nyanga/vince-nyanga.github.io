<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.17.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>A simple task management app using firebase - part 2 | Vincent (Hones) Nyanga</title>
<meta name="description" content="In the previous post we created a simple task management application that had the basic functionalities of adding tasks and marking them as completed. However, the tasks were not being persisted anywhere so as soon as the app is closed everything would disappear. In this post we are going to fix that problem. We are going to do the following:">


  <meta name="author" content="Vincent Nyanga">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_ZA">
<meta property="og:site_name" content="Vincent (Hones) Nyanga">
<meta property="og:title" content="A simple task management app using firebase - part 2">
<meta property="og:url" content="http://localhost:4000/task-management-app-with-firebase-2/">


  <meta property="og:description" content="In the previous post we created a simple task management application that had the basic functionalities of adding tasks and marking them as completed. However, the tasks were not being persisted anywhere so as soon as the app is closed everything would disappear. In this post we are going to fix that problem. We are going to do the following:">







  <meta property="article:published_time" content="2016-12-30T00:00:00+02:00">





  

  


<link rel="canonical" href="http://localhost:4000/task-management-app-with-firebase-2/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Vincent Nyanga",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Vincent (Hones) Nyanga Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/img/logo.png" alt=""></a>
        
        <a class="site-title" href="/">
          Vincent (Hones) Nyanga
          <span class="site-subtitle">Personal blog</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/year-archive/" >Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/weekly-lessons/" >Weekly Lessons</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="https://avatars2.githubusercontent.com/u/13013852?v=3&u=0e1bc9da031c3b0fed315dcf2869b3cc38b7e232&s=400" alt="Vincent Nyanga" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Vincent Nyanga</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Software engineer</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Johannesburg, ZA</span>
        </li>
      

      
        
          
            <li><a href="https://www.linkedin.com/in/vincentnyanga/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
          
        
          
            <li><a href="https://github.com/vince-nyanga/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="A simple task management app using firebase - part 2">
    <meta itemprop="description" content="In the previous post we created a simple task management application that had the basic functionalities of adding tasks and marking them as completed. However, the tasks were not being persisted anywhere so as soon as the app is closed everything would disappear. In this post we are going to fix that problem. We are going to do the following:">
    <meta itemprop="datePublished" content="December 30, 2016">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">A simple task management app using firebase - part 2
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  6 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>In the <a href="https://vince-nyanga.github.io/task-management-app-with-firebase-1/">previous post</a> we created a simple task management application that had the basic functionalities of adding tasks and marking them as completed. However, the tasks were not being persisted anywhere so as soon as the app is closed everything would disappear. In this post we are going to fix that problem. We are going to do the following:</p>

<ul>
  <li>Connect to Firebase</li>
  <li>Read from and write to the realtime database</li>
  <li>Use Firebase UI library to connnect the app’s UI to the realtime database</li>
</ul>

<h2 id="realtime-database">Realtime database</h2>

<p>The Firebase realtime database is a cloud-hosted NoSQL database that stores data as JSON. Data is synced to all connected devices in a matter of milliseconds. It also has offline support. If you want to know more about the realtime database visit the Firebase website.</p>

<h3 id="connecting-to-firebase">Connecting to Firebase</h3>

<p>With your Task Manager project open in Android Studio, go to <em><strong>Tools -&gt; Firebase</strong></em>. When the Firebase panel is open click on <em><strong>Realtime database -&gt; Save and retrieve data</strong></em> then click <em><strong>Connect to database</strong></em>. You might be prompted to login with your google account. Once you are logged in, a dialog will appear from which you will either create a new Firebase project or connect to an existing one. In our case we will create a new project so make sure the <em><strong>Create a new Firebase project</strong></em> radio button is check. Next give your project a name if you don’t want it to have the same name as your application. When you are done click <em><strong>Connect to Firebase</strong></em>. Once you are connected to Firebase select <em><strong>Add the realtime database to your app</strong></em>. Android Studio will add all the required dependencies in your <code class="highlighter-rouge">build.gradle</code> files and download a <code class="highlighter-rouge">google-services.json</code> file containing all the data required by google play services. Now that we are connected to Firebase and have added the realtime database let’s get started.</p>

<h3 id="database-rules">Database rules</h3>

<p>The realtime database comes with a set of rules by default to make sure that user data is secure. To see these rules go to the <a href="https://console.firebase.google.com/">firebase console</a> and open your Task Manager project. Select database on the menu and go to the rules tab. Your see a json object that looks like this:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"rules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">".read"</span><span class="p">:</span><span class="w"> </span><span class="s2">"auth != null"</span><span class="p">,</span><span class="w">
    </span><span class="nl">".write"</span><span class="p">:</span><span class="w"> </span><span class="s2">"auth != null"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>What the rules above simply mean is that only authenticated users are allowed to read from and write to the database. We will discuss database rules in detail in later posts. For now let’s loosen the rules a bit so that we can be able to access the database without the need for authentication, a functionality that will be added in the next post. Edit your rules to look like this and click <em><strong>publish</strong></em>:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"rules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">".read"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">".write"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>This is not a recommended thing to do so you will get a warning from firebase. Let’s ignore the warning for now and proceed.</p>

<h3 id="firebase-ui">Firebase UI</h3>

<p>Firebase UI is a library that allows us to quickly connect common android UI elements to Firebase APIs like the realtime database, authentication and storage. We are going to use this library to connect our tasks ListView to the realtime database. Add <code class="highlighter-rouge">compile 'com.firebaseui:firebase-ui-database:1.0.1'</code> to your <code class="highlighter-rouge">app/build.gradle</code> file and sync. We are now all set to dive into code.</p>

<h3 id="edit-task-model">Edit Task model</h3>

<p>Open <code class="highlighter-rouge">Task.java</code> and add the following method:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     <span class="o">**</span>
     <span class="o">*</span> <span class="nc">The</span> <span class="nc">Firebase</span> <span class="n">realtime</span> <span class="n">database</span> <span class="n">only</span> <span class="n">supports</span> <span class="n">the</span> <span class="n">following</span> <span class="o">:</span>
     <span class="o">*</span>  <span class="nc">String</span>
     <span class="o">*</span>  <span class="nc">Long</span>
     <span class="o">*</span>  <span class="nc">Double</span>
     <span class="o">*</span>  <span class="nc">Boolean</span>
     <span class="o">*</span>  <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span>
     <span class="o">*</span>  <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span>
     <span class="o">*</span>
     <span class="o">*</span>  <span class="nc">So</span> <span class="n">we</span> <span class="n">convert</span> <span class="n">the</span> <span class="nc">Task</span> <span class="n">object</span> <span class="n">into</span> <span class="n">a</span> <span class="n">map</span> <span class="n">before</span> <span class="n">we</span> <span class="n">save</span> <span class="n">to</span> <span class="n">database</span>
     <span class="o">*</span> <span class="o">*/</span>
    <span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="nf">toMap</span><span class="o">(){</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span><span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"done"</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="na">done</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">map</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></div></div>

<h3 id="edit-mainactivity">Edit MainActivity</h3>

<p>Open <code class="highlighter-rouge">MainActivity.java</code> and make the following changes and remove the following lines of code and all the other parts they affect:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="nc">TasksAdapter</span> <span class="n">adpter</span><span class="o">;</span>
<span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Task</span><span class="o">&gt;</span> <span class="n">tasks</span><span class="o">;</span>
</code></pre></div></div>

<p>Once you have cleaned up all errors that appear after the above change, add the following:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">private</span> <span class="nc">DatabaseReference</span> <span class="n">tasksRef</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">FirebaseListAdapter</span><span class="o">&lt;</span><span class="nc">Task</span><span class="o">&gt;</span> <span class="n">adapter</span><span class="o">;</span>
</code></pre></div></div>

<p>In the <code class="highlighter-rouge">onCreate()</code> method let’s initialise the <code class="highlighter-rouge">taskRef</code> object:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tasksRef</span> <span class="o">=</span> <span class="nc">FirebaseDatabase</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">getReference</span><span class="o">().</span><span class="na">child</span><span class="o">(</span><span class="s">"tasks"</span><span class="o">);</span>
</code></pre></div></div>

<p>The code above connects to the Firebase realtime database at a child node named <em><strong>tasks</strong></em>. As mentioned above, the realtime database stores data as JSON so we will create a node in which we will store all our tasks. In case we want to store user data we will then create another node <code class="highlighter-rouge">users</code>. This approach makes it easy to manage our data.</p>

<p>While you are still inside the <code class="highlighter-rouge">onCreate()</code> method and the following lines of code:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">adapter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FirebaseListAdapter</span><span class="o">&lt;</span><span class="nc">Task</span><span class="o">&gt;(</span><span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="nc">Task</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">task_list_item</span><span class="o">,</span> <span class="n">tasksRef</span><span class="o">)</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">populateView</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">,</span> <span class="nc">Task</span> <span class="n">task</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">TextView</span> <span class="n">taskName</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TextView</span><span class="o">)</span> <span class="n">view</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">task_name</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">task</span><span class="o">.</span><span class="na">isDone</span><span class="o">())</span> <span class="o">{</span>
                    <span class="c1">// If the task is done (completed) we strike through it.</span>
                    <span class="n">taskName</span><span class="o">.</span><span class="na">setPaintFlags</span><span class="o">(</span><span class="n">taskName</span><span class="o">.</span><span class="na">getPaintFlags</span><span class="o">()</span> <span class="o">|</span> <span class="nc">Paint</span><span class="o">.</span><span class="na">STRIKE_THRU_TEXT_FLAG</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">taskName</span><span class="o">.</span><span class="na">setPaintFlags</span><span class="o">(</span><span class="n">taskName</span><span class="o">.</span><span class="na">getPaintFlags</span><span class="o">()</span> <span class="o">&amp;</span> <span class="o">(~</span><span class="nc">Paint</span><span class="o">.</span><span class="na">STRIKE_THRU_TEXT_FLAG</span><span class="o">));</span>
                <span class="o">}</span>
                <span class="n">taskName</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">task</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">};</span>
<span class="n">taskList</span><span class="o">.</span><span class="na">setAdapter</span><span class="o">(</span><span class="n">adapter</span><span class="o">);</span>
</code></pre></div></div>

<p>In the code above we are initialising the <code class="highlighter-rouge">FirebaseListAdapter</code> provided in the Firebase UI library. This performs the same task as the <code class="highlighter-rouge">TasksAdapter</code> in part 1 except that instead of taking a list of tasks, it connects to a Firebase database reference. It takes all the tasks from the realtime database and loads them into our ListView and is also responsible for ensuring that the ListView is always in sync with the realtime database.</p>

<p>Now let’s update the <code class="highlighter-rouge">onItemClickListener</code> for our ListView. Add the following code:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">taskList</span><span class="o">.</span><span class="na">setOnItemClickListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">AdapterView</span><span class="o">.</span><span class="na">OnItemClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onItemClick</span><span class="o">(</span><span class="nc">AdapterView</span><span class="o">&lt;?&gt;</span> <span class="n">adapterView</span><span class="o">,</span> <span class="nc">View</span> <span class="n">view</span><span class="o">,</span> <span class="kt">int</span> <span class="n">position</span><span class="o">,</span> <span class="kt">long</span> <span class="n">l</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">Task</span> <span class="n">task</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="na">getItem</span><span class="o">(</span><span class="n">position</span><span class="o">);</span>
                <span class="n">task</span><span class="o">.</span><span class="na">setDone</span><span class="o">(!</span><span class="n">task</span><span class="o">.</span><span class="na">isDone</span><span class="o">());</span>
                <span class="n">tasksRef</span><span class="o">.</span><span class="na">child</span><span class="o">(</span><span class="n">adapter</span><span class="o">.</span><span class="na">getRef</span><span class="o">(</span><span class="n">position</span><span class="o">).</span><span class="na">getKey</span><span class="o">()).</span><span class="na">updateChildren</span><span class="o">(</span><span class="n">task</span><span class="o">.</span><span class="na">toMap</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">});</span>
</code></pre></div></div>

<p>The code above changes the <code class="highlighter-rouge">done</code> attribute of the clicked task and updates the realtime database. Now add the following line of code in the <code class="highlighter-rouge">onTaskAdded()</code> method to add the new task to the realtime database:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tasksRef</span><span class="o">.</span><span class="na">push</span><span class="o">().</span><span class="na">setValue</span><span class="o">(</span><span class="n">task</span><span class="o">.</span><span class="na">toMap</span><span class="o">());</span>
</code></pre></div></div>

<p>Lastly let’s do some cleanup:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onDestroy</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onDestroy</span><span class="o">();</span>
        <span class="n">adapter</span><span class="o">.</span><span class="na">cleanup</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>Now your <code class="highlighter-rouge">MainActivity.java</code> should be looking like this:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="nc">AppCompatActivity</span> <span class="kd">implements</span> <span class="nc">AddTaskFragment</span><span class="o">.</span><span class="na">TaskCallbackListener</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">ListView</span> <span class="n">taskList</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">FloatingActionButton</span> <span class="n">addButton</span><span class="o">;</span>


    <span class="kd">private</span> <span class="nc">DatabaseReference</span> <span class="n">tasksRef</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">FirebaseListAdapter</span><span class="o">&lt;</span><span class="nc">Task</span><span class="o">&gt;</span> <span class="n">adapter</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>


        <span class="n">taskList</span> <span class="o">=</span> <span class="o">(</span><span class="nc">ListView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">task_list</span><span class="o">);</span>
        <span class="n">addButton</span> <span class="o">=</span> <span class="o">(</span><span class="nc">FloatingActionButton</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">add_btn</span><span class="o">);</span>

        <span class="n">tasksRef</span> <span class="o">=</span> <span class="nc">FirebaseDatabase</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">getReference</span><span class="o">().</span><span class="na">child</span><span class="o">(</span><span class="s">"tasks"</span><span class="o">);</span>
        <span class="n">adapter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FirebaseListAdapter</span><span class="o">&lt;</span><span class="nc">Task</span><span class="o">&gt;(</span><span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="nc">Task</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">task_list_item</span><span class="o">,</span> <span class="n">tasksRef</span><span class="o">)</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">populateView</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">,</span> <span class="nc">Task</span> <span class="n">task</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">TextView</span> <span class="n">taskName</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TextView</span><span class="o">)</span> <span class="n">view</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">task_name</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">task</span><span class="o">.</span><span class="na">isDone</span><span class="o">())</span> <span class="o">{</span>
                    <span class="c1">// If the task is done (completed) we strike through it.</span>
                    <span class="n">taskName</span><span class="o">.</span><span class="na">setPaintFlags</span><span class="o">(</span><span class="n">taskName</span><span class="o">.</span><span class="na">getPaintFlags</span><span class="o">()</span> <span class="o">|</span> <span class="nc">Paint</span><span class="o">.</span><span class="na">STRIKE_THRU_TEXT_FLAG</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">taskName</span><span class="o">.</span><span class="na">setPaintFlags</span><span class="o">(</span><span class="n">taskName</span><span class="o">.</span><span class="na">getPaintFlags</span><span class="o">()</span> <span class="o">&amp;</span> <span class="o">(~</span><span class="nc">Paint</span><span class="o">.</span><span class="na">STRIKE_THRU_TEXT_FLAG</span><span class="o">));</span>
                <span class="o">}</span>
                <span class="n">taskName</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">task</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">};</span>
        <span class="n">taskList</span><span class="o">.</span><span class="na">setAdapter</span><span class="o">(</span><span class="n">adapter</span><span class="o">);</span>
        <span class="n">taskList</span><span class="o">.</span><span class="na">setEmptyView</span><span class="o">(</span><span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">placeholder_txt</span><span class="o">));</span>

        <span class="n">taskList</span><span class="o">.</span><span class="na">setOnItemClickListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">AdapterView</span><span class="o">.</span><span class="na">OnItemClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onItemClick</span><span class="o">(</span><span class="nc">AdapterView</span><span class="o">&lt;?&gt;</span> <span class="n">adapterView</span><span class="o">,</span> <span class="nc">View</span> <span class="n">view</span><span class="o">,</span> <span class="kt">int</span> <span class="n">position</span><span class="o">,</span> <span class="kt">long</span> <span class="n">l</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">Task</span> <span class="n">task</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="na">getItem</span><span class="o">(</span><span class="n">position</span><span class="o">);</span>
                <span class="n">task</span><span class="o">.</span><span class="na">setDone</span><span class="o">(!</span><span class="n">task</span><span class="o">.</span><span class="na">isDone</span><span class="o">());</span>
                <span class="n">tasksRef</span><span class="o">.</span><span class="na">child</span><span class="o">(</span><span class="n">adapter</span><span class="o">.</span><span class="na">getRef</span><span class="o">(</span><span class="n">position</span><span class="o">).</span><span class="na">getKey</span><span class="o">()).</span><span class="na">updateChildren</span><span class="o">(</span><span class="n">task</span><span class="o">.</span><span class="na">toMap</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">});</span>

        <span class="n">addButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">AddTaskFragment</span><span class="o">.</span><span class="na">newInstance</span><span class="o">().</span><span class="na">show</span><span class="o">(</span><span class="n">getFragmentManager</span><span class="o">(),</span><span class="s">"new_task"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onTaskAdded</span><span class="o">(</span><span class="nc">Task</span> <span class="n">task</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">tasksRef</span><span class="o">.</span><span class="na">push</span><span class="o">().</span><span class="na">setValue</span><span class="o">(</span><span class="n">task</span><span class="o">.</span><span class="na">toMap</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onDestroy</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onDestroy</span><span class="o">();</span>
        <span class="n">adapter</span><span class="o">.</span><span class="na">cleanup</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Run the app and add a new task. If you see the task apearing in your ListView then it means you’ve done everything right. Now go to your project in the Firebase console and open the database section. You should see the task you have added. If you close your app and open again you will find that the task you added didn’t disappear - it’s now saved in firebase.</p>

<h2 id="conclusion">Conclusion</h2>

<p>In this part we connected our app to Firebase and added the realtime database. We also used the Firebase UI library to easily connect our ListView to the realtime database. We successfully added and retrieved tasks to the realtime database. Cool!!! In the next post we are going to add more functionalities to the app. Thanks for reading :)</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#android" class="page__taxonomy-item" rel="tag">Android</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#firebase" class="page__taxonomy-item" rel="tag">Firebase</a>
    
    </span>
  </p>




        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2016-12-30T00:00:00+02:00">December 30, 2016</time></p>
        
      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=A+simple+task+management+app+using+firebase+-+part+2%20http%3A%2F%2Flocalhost%3A4000%2Ftask-management-app-with-firebase-2%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Ftask-management-app-with-firebase-2%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Ftask-management-app-with-firebase-2%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/task-management-app-with-firebase-1/" class="pagination--pager" title="A simple task management app using firebase - part 1
">Previous</a>
    
    
      <a href="/task-management-app-with-firebase-3/" class="pagination--pager" title="A simple task management app using firebase - part 3
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/creating-uml-diagrams-made-easy/" rel="permalink">Creating UML Diagrams With Ease Using PlantText
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Unified Modeling Language (UML) has been around the software development circles for a fairly long time now. It helps provide a standardised way to visualise...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/building-resilient-applications-with-polly-part-2/" rel="permalink">Building Resilient .NET Core Applications With Polly’s Circuit Breaker Policy
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">In the previous post we introduced Polly, a .NET resilience and transient-fault-handling library. We spoke about the retry policy that can be used to help yo...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/building-resilient-applications-with-polly-part-1/" rel="permalink">Building Resilient .NET Core Applications With Polly’s Retry Policy
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">In this age of Service Oriented Architecture (SOA) where small microservices within a system communicate with each other using various protocols, typically o...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/facial-recognition-with-kairos/" rel="permalink">Facial Recognition In .NET With Kairos
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">A little over 2 years ago I worked on a project that involved facial recognition. Even though I eventually used Python for the project, I initially wanted to...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://www.linkedin.com/in/vincentnyanga/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://github.com/vince-nyanga/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Vincent Nyanga.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
