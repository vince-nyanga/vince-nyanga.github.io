<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.17.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Consuming HTTP Resources In Flutter | Vincent (Hones) Nyanga</title>
<meta name="description" content="Almost every mobile app consumes HTTP resources one way or the other – fetching data from a web service, authenticating users and many more examples. In Flutter this is no different – your app is going to communicate to some service somewhere via HTTP. In this post we are going to talk about a package you can use in your Flutter application to consume HTTP resources – the http package.">


  <meta name="author" content="Vincent Nyanga">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_ZA">
<meta property="og:site_name" content="Vincent (Hones) Nyanga">
<meta property="og:title" content="Consuming HTTP Resources In Flutter">
<meta property="og:url" content="http://localhost:4000/consuming-http-resources-in-flutter/">


  <meta property="og:description" content="Almost every mobile app consumes HTTP resources one way or the other – fetching data from a web service, authenticating users and many more examples. In Flutter this is no different – your app is going to communicate to some service somewhere via HTTP. In this post we are going to talk about a package you can use in your Flutter application to consume HTTP resources – the http package.">







  <meta property="article:published_time" content="2020-02-15T00:00:00+02:00">





  

  


<link rel="canonical" href="http://localhost:4000/consuming-http-resources-in-flutter/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Vincent Nyanga",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Vincent (Hones) Nyanga Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/img/logo.png" alt=""></a>
        
        <a class="site-title" href="/">
          Vincent (Hones) Nyanga
          <span class="site-subtitle">Personal blog</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/year-archive/" >Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/weekly-lessons/" >Weekly Lessons</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="https://avatars2.githubusercontent.com/u/13013852?v=3&u=0e1bc9da031c3b0fed315dcf2869b3cc38b7e232&s=400" alt="Vincent Nyanga" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Vincent Nyanga</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Software engineer</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Johannesburg, ZA</span>
        </li>
      

      
        
          
            <li><a href="https://www.linkedin.com/in/vincentnyanga/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
          
        
          
            <li><a href="https://github.com/vince-nyanga/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Consuming HTTP Resources In Flutter">
    <meta itemprop="description" content="Almost every mobile app consumes HTTP resources one way or the other – fetching data from a web service, authenticating users and many more examples. In Flutter this is no different – your app is going to communicate to some service somewhere via HTTP. In this post we are going to talk about a package you can use in your Flutter application to consume HTTP resources – the http package.">
    <meta itemprop="datePublished" content="February 15, 2020">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Consuming HTTP Resources In Flutter
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>Almost every mobile app consumes HTTP resources one way or the other – fetching data from a web service, authenticating users and many more examples. In Flutter this is no different – your app is going to communicate to some service somewhere via HTTP. In this post we are going to talk about a package you can use in your Flutter application to consume HTTP resources – the <a href="https://pub.dev/packages/http">http</a> package.</p>

<p>The <code class="highlighter-rouge">http</code> package is an official, platform-independent, <code class="highlighter-rouge">Dart</code> package that contains a set of high-level functions that make it easy to consume HTTP resources. It is very intuitive and simple to use. Here are examples of how you can use the package to make HTTP requests:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">import</span> <span class="err">'</span><span class="n">package</span><span class="p">:</span><span class="n">http</span><span class="p">/</span><span class="n">http</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span> <span class="k">as</span> <span class="n">http</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyHttpService</span> <span class="p">{</span>
    <span class="nf">MyHttpService</span><span class="p">({</span><span class="k">this</span><span class="p">.</span><span class="n">baseUrl</span><span class="p">});</span>

    <span class="n">final</span> <span class="n">String</span> <span class="n">baseUrl</span><span class="p">;</span>

    <span class="c1">// GET</span>
    <span class="n">Future</span><span class="p">&lt;</span><span class="n">http</span><span class="p">.</span><span class="n">Response</span><span class="p">&gt;</span> <span class="nf">getItems</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">http</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="err">'$</span><span class="n">baseUrl</span><span class="p">/</span><span class="n">items</span><span class="p">/</span><span class="err">'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// POST</span>
    <span class="n">Future</span><span class="p">&lt;</span><span class="n">http</span><span class="p">.</span><span class="n">Response</span><span class="p">&gt;</span> <span class="nf">addItem</span><span class="p">(</span><span class="n">Item</span> <span class="n">item</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">http</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="err">'$</span><span class="n">baseUrl</span><span class="p">/</span><span class="n">items</span><span class="p">/</span><span class="err">'</span><span class="p">,</span>
                          <span class="n">body</span><span class="p">:</span> <span class="p">{</span><span class="err">'</span><span class="n">name</span><span class="err">'</span><span class="p">:</span> <span class="n">item</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="err">'</span><span class="n">price</span><span class="err">'</span><span class="p">:</span> <span class="n">item</span><span class="p">.</span><span class="n">price</span><span class="p">});</span>

    <span class="p">}</span>

    <span class="c1">// PUT</span>
    <span class="n">Future</span><span class="p">&lt;</span><span class="n">http</span><span class="p">.</span><span class="n">Response</span><span class="p">&gt;</span> <span class="nf">updateItem</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">price</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">http</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="err">'$</span><span class="n">baseUrl</span><span class="p">/</span><span class="n">items</span><span class="p">/</span><span class="err">$</span><span class="n">id</span><span class="p">/</span><span class="err">'</span><span class="p">,</span>
                          <span class="n">body</span><span class="p">:</span> <span class="p">{</span><span class="err">'</span><span class="n">name</span><span class="err">'</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="err">'</span><span class="n">price</span><span class="err">'</span><span class="p">:</span> <span class="n">price</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="c1">// DELETE</span>
    <span class="n">Future</span><span class="p">&lt;</span><span class="n">http</span><span class="p">.</span><span class="n">Response</span><span class="p">&gt;</span> <span class="nf">deleteItem</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">http</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="err">'$</span><span class="n">baseUrl</span><span class="p">/</span><span class="n">items</span><span class="p">/</span><span class="err">$</span><span class="n">id</span><span class="p">/</span><span class="err">'</span><span class="p">);</span>
    <span class="p">}</span>


<span class="p">}</span>
</code></pre></div></div>

<p>The above examples show how you can make various HTTP calls using the <code class="highlighter-rouge">http</code> package. As you may have noticed, <code class="highlighter-rouge">http</code> methods return <code class="highlighter-rouge">Future</code>s. In Dart, a <code class="highlighter-rouge">Future</code> object represents a potential value or error that will be available in the future. Since all HTTP calls are asynchronous, we make use of the <code class="highlighter-rouge">Future</code> class as we await the result that will come at a later stage.</p>

<h2 id="example">Example</h2>

<p>Let us now put the <code class="highlighter-rouge">http</code> package into use by creating a dummy application that utilises it. The application is going to consume resources from the <a href="https://jsonplaceholder.typicode.com/">JSONPlaceholder</a> service – a fake online REST API used for testing and prototyping.</p>

<h3 id="posts-repository">Posts Repository</h3>

<p>Our example app will use the <code class="highlighter-rouge">http</code> package to fetch fake posts from the <a href="https://jsonplaceholder.typicode.com/">JSONPlaceholder</a> API and display them in a list. We will focus on the use of the <code class="highlighter-rouge">http</code> package and the UI. The rest of the code (<code class="highlighter-rouge">BLoC</code>s etc) can be found on <a href="https://github.com/vince-nyanga/flutter_http_tutorial">GitHub</a>.</p>

<p>Let’s create a Flutter application and add the following dependencies to the <code class="highlighter-rouge">pubsec.yaml</code> file:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># pubsec.yaml</span>

<span class="c1"># ...</span>

<span class="na">dependencies</span><span class="pi">:</span>
  <span class="c1"># ...</span>
  <span class="na">http</span><span class="pi">:</span> <span class="s">^0.12.0+4</span>
  <span class="na">bloc</span><span class="pi">:</span> <span class="s">^3.0.0</span>
  <span class="na">flutter_bloc</span><span class="pi">:</span> <span class="s">^3.2.0</span>
  <span class="na">equatable</span><span class="pi">:</span> <span class="s">^1.1.0</span>
<span class="c1"># ...</span>
</code></pre></div></div>

<p>Now let’s create our <code class="highlighter-rouge">Post</code> model. Inside the <code class="highlighter-rouge">lib</code> directory add another directory called <code class="highlighter-rouge">models</code> and add a file <code class="highlighter-rouge">post.dart</code> therein. Add the following code to the <code class="highlighter-rouge">post.dart</code> file:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// lib/models/post.dart</span>

<span class="n">import</span> <span class="err">'</span><span class="n">package</span><span class="p">:</span><span class="n">meta</span><span class="p">/</span><span class="n">meta</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Post</span> <span class="p">{</span>
  <span class="n">final</span> <span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
  <span class="n">final</span> <span class="kt">int</span> <span class="n">userId</span><span class="p">;</span>
  <span class="n">final</span> <span class="n">String</span> <span class="n">title</span><span class="p">;</span>
  <span class="n">final</span> <span class="n">String</span> <span class="n">body</span><span class="p">;</span>

  <span class="nf">Post</span><span class="p">({</span><span class="n">@required</span> <span class="k">this</span><span class="p">.</span><span class="n">id</span><span class="p">,</span> <span class="n">@required</span> <span class="k">this</span><span class="p">.</span><span class="n">userId</span><span class="p">,</span> <span class="n">@required</span> <span class="k">this</span><span class="p">.</span><span class="n">title</span><span class="p">,</span> <span class="n">@required</span> <span class="k">this</span><span class="p">.</span><span class="n">body</span><span class="p">});</span>

  <span class="n">factory</span> <span class="n">Post</span><span class="p">.</span><span class="nf">fromJson</span><span class="p">(</span><span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="kt">dynamic</span><span class="p">&gt;</span> <span class="n">json</span><span class="p">){</span>
    <span class="k">return</span> <span class="nf">Post</span><span class="p">(</span>
      <span class="n">id</span><span class="p">:</span> <span class="n">json</span><span class="p">[</span><span class="err">'</span><span class="n">id</span><span class="err">'</span><span class="p">],</span>
      <span class="n">userId</span><span class="p">:</span> <span class="n">json</span><span class="p">[</span><span class="err">'</span><span class="n">userId</span><span class="err">'</span><span class="p">],</span>
      <span class="n">title</span><span class="p">:</span> <span class="n">json</span><span class="p">[</span><span class="err">'</span><span class="n">title</span><span class="err">'</span><span class="p">],</span>
      <span class="n">body</span><span class="p">:</span> <span class="n">json</span><span class="p">[</span><span class="err">'</span><span class="n">body</span><span class="err">'</span><span class="p">]</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="n">@override</span>
  <span class="n">String</span> <span class="nf">toString</span><span class="p">()</span> <span class="p">=&gt;</span>
      <span class="err">'</span><span class="n">Post</span> <span class="p">{</span> <span class="n">id</span><span class="p">:</span> <span class="err">$</span><span class="n">id</span><span class="p">,</span> <span class="n">userId</span><span class="p">:</span> <span class="err">$</span><span class="n">userId</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="err">$</span><span class="n">title</span><span class="p">,</span> <span class="n">body</span><span class="p">:</span> <span class="err">$</span><span class="n">body</span> <span class="p">}</span><span class="err">'</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<p>We now need to create a <code class="highlighter-rouge">PostRepository</code> that will be responsible for fetching posts from our REST API. Inside the <code class="highlighter-rouge">lib</code> directory add <code class="highlighter-rouge">repositories/posts/post_repository.dart</code> to which you will add the following code:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// lib/repositories/posts/post_repository.dart</span>

<span class="n">import</span> <span class="err">'</span><span class="n">dart</span><span class="p">:</span><span class="n">convert</span><span class="err">'</span><span class="p">;</span>

<span class="n">import</span> <span class="err">'</span><span class="n">package</span><span class="p">:</span><span class="n">http</span><span class="p">/</span><span class="n">http</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span> <span class="k">as</span> <span class="n">http</span><span class="p">;</span>
<span class="n">import</span> <span class="err">'</span><span class="p">../../</span><span class="n">models</span><span class="p">/</span><span class="n">post</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>

<span class="k">abstract</span> <span class="k">class</span> <span class="nc">PostRepository</span> <span class="p">{</span>
  <span class="n">Future</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Post</span><span class="p">&gt;&gt;</span> <span class="nf">getPosts</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">HttpPostRepository</span> <span class="n">extends</span> <span class="n">PostRepository</span> <span class="p">{</span>
  <span class="n">final</span> <span class="n">String</span> <span class="n">baseUrl</span><span class="p">;</span>

  <span class="nf">HttpPostRepository</span><span class="p">({</span><span class="k">this</span><span class="p">.</span><span class="n">baseUrl</span> <span class="p">=</span> <span class="err">'</span><span class="n">https</span><span class="p">:</span><span class="c1">//jsonplaceholder.typicode.com'}) : assert(baseUrl != null);</span>

  <span class="n">@override</span>
  <span class="n">Future</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Post</span><span class="p">&gt;&gt;</span> <span class="nf">getPosts</span><span class="p">()</span> <span class="k">async</span> <span class="p">{</span>
    <span class="n">final</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">http</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="err">'$</span><span class="n">baseUrl</span><span class="p">/</span><span class="n">posts</span><span class="err">'</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span> <span class="p">==</span> <span class="m">200</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">final</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">dynamic</span><span class="p">&gt;</span> <span class="n">postsJson</span> <span class="p">=</span> <span class="nf">jsonDecode</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">body</span><span class="p">);</span>
      <span class="k">return</span> <span class="n">postsJson</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="n">json</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">Post</span><span class="p">.</span><span class="nf">fromJson</span><span class="p">(</span><span class="n">json</span><span class="p">)).</span><span class="nf">toList</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="nf">Exception</span><span class="p">(</span><span class="err">'</span><span class="n">Failed</span> <span class="n">to</span> <span class="n">load</span> <span class="n">posts</span><span class="err">'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p>The <code class="highlighter-rouge">HttpPostRepository</code>, which extends an abstract <code class="highlighter-rouge">PostRepository</code>, fetches posts from our API as JSON, converts them to a <code class="highlighter-rouge">List&lt;Post&gt;</code> and returns the list. Note that the <code class="highlighter-rouge">getPosts</code> method returns a <code class="highlighter-rouge">Future</code> which means it is going to run asynchronously.</p>

<h3 id="user-interface">User Interface</h3>

<p>Let’s now turn our attention to the UI. I have deliberately left out the code that implements the <code class="highlighter-rouge">BLoC</code> pattern for this app for brevity. Like I said earlier, you may check the complete project on <a href="https://github.com/vince-nyanga/flutter_http_tutorial">GitHub</a>. If you want to learn more about the <code class="highlighter-rouge">BLoC</code> pattern check out this <a href="/state-management-in-flutter-bloc-pattern/">post</a> and this <a href="/flutter-authentication-with-bloc-architecture/">post</a>.</p>

<p>Create a directory called <code class="highlighter-rouge">pages</code> and add <code class="highlighter-rouge">posts_page.dart</code>. Inside the <code class="highlighter-rouge">posts_page.dart</code> file, add the following code:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// lib/pages/posts_page.dart</span>

<span class="n">import</span> <span class="err">'</span><span class="n">package</span><span class="p">:</span><span class="n">flutter</span><span class="p">/</span><span class="n">cupertino</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>
<span class="n">import</span> <span class="err">'</span><span class="n">package</span><span class="p">:</span><span class="n">flutter</span><span class="p">/</span><span class="n">material</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>
<span class="n">import</span> <span class="err">'</span><span class="n">package</span><span class="p">:</span><span class="n">flutter_bloc</span><span class="p">/</span><span class="n">flutter_bloc</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>

<span class="n">import</span> <span class="err">'</span><span class="p">../</span><span class="n">blocs</span><span class="p">/</span><span class="n">posts</span><span class="p">/</span><span class="n">post_bloc</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>
<span class="n">import</span> <span class="err">'</span><span class="p">../</span><span class="n">blocs</span><span class="p">/</span><span class="n">posts</span><span class="p">/</span><span class="n">post_state</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">PostsPage</span> <span class="n">extends</span> <span class="n">StatelessWidget</span> <span class="p">{</span>
  <span class="n">@override</span>
  <span class="n">Widget</span> <span class="nf">build</span><span class="p">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nf">CupertinoPageScaffold</span><span class="p">(</span>
      <span class="n">child</span><span class="p">:</span> <span class="n">BlocBuilder</span><span class="p">&lt;</span><span class="n">PostsBloc</span><span class="p">,</span> <span class="n">PostsState</span><span class="p">&gt;(</span>
        <span class="n">builder</span><span class="p">:</span> <span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="k">is</span> <span class="n">PostsStateError</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nf">_buildErrorView</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="k">is</span> <span class="n">PostsStateLoaded</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nf">_buildPostsView</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">return</span> <span class="nf">_buildLoadingView</span><span class="p">();</span>
        <span class="p">},</span>
      <span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="n">Widget</span> <span class="nf">_buildErrorView</span><span class="p">(</span><span class="n">PostsStateError</span> <span class="n">state</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">final</span> <span class="n">sliver</span> <span class="p">=</span> <span class="nf">SliverList</span><span class="p">(</span>
      <span class="k">delegate</span><span class="p">:</span> <span class="nf">SliverChildBuilderDelegate</span><span class="p">((</span><span class="n">context</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nf">Container</span><span class="p">(</span>
          <span class="n">height</span><span class="p">:</span> <span class="n">MediaQuery</span><span class="p">.</span><span class="nf">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">size</span><span class="p">.</span><span class="n">height</span> <span class="p">*</span> <span class="p">.</span><span class="m">7</span><span class="p">,</span>
          <span class="n">child</span><span class="p">:</span> <span class="nf">Center</span><span class="p">(</span>
            <span class="n">child</span><span class="p">:</span> <span class="nf">Text</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="n">message</span><span class="p">),</span>
          <span class="p">),</span>
        <span class="p">);</span>
      <span class="p">},</span> <span class="n">childCount</span><span class="p">:</span> <span class="m">1</span><span class="p">),</span>
    <span class="p">);</span>
    <span class="k">return</span> <span class="nf">_buildFromBaseView</span><span class="p">(</span><span class="n">sliver</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">Widget</span> <span class="nf">_buildPostsView</span><span class="p">(</span><span class="n">PostsStateLoaded</span> <span class="n">state</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">final</span> <span class="n">sliver</span> <span class="p">=</span> <span class="nf">SliverList</span><span class="p">(</span>
      <span class="k">delegate</span><span class="p">:</span> <span class="nf">SliverChildBuilderDelegate</span><span class="p">((</span><span class="n">context</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">final</span> <span class="n">post</span> <span class="p">=</span> <span class="n">state</span><span class="p">.</span><span class="n">posts</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
        <span class="k">return</span> <span class="nf">Column</span><span class="p">(</span>
          <span class="n">crossAxisAlignment</span><span class="p">:</span> <span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">stretch</span><span class="p">,</span>
          <span class="n">children</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Widget</span><span class="p">&gt;[</span>
            <span class="nf">Material</span><span class="p">(</span>
              <span class="n">color</span><span class="p">:</span> <span class="n">Colors</span><span class="p">.</span><span class="n">transparent</span><span class="p">,</span>
              <span class="n">child</span><span class="p">:</span> <span class="nf">ListTile</span><span class="p">(</span>
                <span class="n">title</span><span class="p">:</span> <span class="nf">Text</span><span class="p">(</span>
                  <span class="n">post</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
                  <span class="n">softWrap</span><span class="p">:</span> <span class="k">false</span><span class="p">,</span>
                  <span class="n">overflow</span><span class="p">:</span> <span class="n">TextOverflow</span><span class="p">.</span><span class="n">ellipsis</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">subtitle</span><span class="p">:</span> <span class="nf">Text</span><span class="p">(</span>
                  <span class="n">post</span><span class="p">.</span><span class="n">body</span><span class="p">,</span>
                  <span class="n">softWrap</span><span class="p">:</span> <span class="k">false</span><span class="p">,</span>
                  <span class="n">overflow</span><span class="p">:</span> <span class="n">TextOverflow</span><span class="p">.</span><span class="n">ellipsis</span><span class="p">,</span>
                <span class="p">),</span>
              <span class="p">),</span>
            <span class="p">),</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="p">&lt;</span> <span class="n">state</span><span class="p">.</span><span class="n">posts</span><span class="p">.</span><span class="n">length</span> <span class="p">-</span> <span class="m">1</span><span class="p">)</span> <span class="c1">// don't add divider to the last item</span>
              <span class="nf">Divider</span><span class="p">(</span>
                <span class="n">color</span><span class="p">:</span> <span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span>
              <span class="p">)</span>
          <span class="p">],</span>
        <span class="p">);</span>
      <span class="p">},</span> <span class="n">childCount</span><span class="p">:</span> <span class="n">state</span><span class="p">.</span><span class="n">posts</span><span class="p">.</span><span class="n">length</span><span class="p">),</span>
    <span class="p">);</span>
    <span class="k">return</span> <span class="nf">_buildFromBaseView</span><span class="p">(</span><span class="n">sliver</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">Widget</span> <span class="nf">_buildLoadingView</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">final</span> <span class="n">sliver</span> <span class="p">=</span> <span class="nf">SliverList</span><span class="p">(</span>
      <span class="k">delegate</span><span class="p">:</span> <span class="nf">SliverChildBuilderDelegate</span><span class="p">((</span><span class="n">context</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nf">Container</span><span class="p">(</span>
            <span class="n">height</span><span class="p">:</span> <span class="n">MediaQuery</span><span class="p">.</span><span class="nf">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">size</span><span class="p">.</span><span class="n">height</span> <span class="p">*</span> <span class="p">.</span><span class="m">7</span><span class="p">,</span>
            <span class="n">child</span><span class="p">:</span> <span class="nf">Center</span><span class="p">(</span>
              <span class="n">child</span><span class="p">:</span> <span class="nf">CupertinoActivityIndicator</span><span class="p">(),</span>
            <span class="p">));</span>
      <span class="p">},</span> <span class="n">childCount</span><span class="p">:</span> <span class="m">1</span><span class="p">),</span>
    <span class="p">);</span>
    <span class="k">return</span> <span class="nf">_buildFromBaseView</span><span class="p">(</span><span class="n">sliver</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">Widget</span> <span class="nf">_buildFromBaseView</span><span class="p">(</span><span class="n">sliver</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nf">CustomScrollView</span><span class="p">(</span>
      <span class="n">slivers</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Widget</span><span class="p">&gt;[</span>
        <span class="nf">CupertinoSliverNavigationBar</span><span class="p">(</span>
          <span class="n">largeTitle</span><span class="p">:</span> <span class="nf">Text</span><span class="p">(</span><span class="err">'</span><span class="n">Posts</span><span class="err">'</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="nf">SliverSafeArea</span><span class="p">(</span>
          <span class="n">top</span><span class="p">:</span> <span class="k">false</span><span class="p">,</span>
          <span class="n">minimum</span><span class="p">:</span> <span class="k">const</span> <span class="n">EdgeInsets</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
          <span class="n">sliver</span><span class="p">:</span> <span class="n">sliver</span><span class="p">,</span>
        <span class="p">)</span>
      <span class="p">],</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p>Our <code class="highlighter-rouge">PostsPage</code> widget is a <code class="highlighter-rouge">CupertinoPageScaffold</code>, a widget in the <code class="highlighter-rouge">cupertino</code> package, that gives our page an iOS look-and-feel. We have also used a <code class="highlighter-rouge">CustomScrollView</code> with <code class="highlighter-rouge">CupertinoSliverNavigationBar</code> and <code class="highlighter-rouge">SliverSafeArea</code>. All this will give our page iOS behaviour when we scroll through the list of posts. We will talk more about <code class="highlighter-rouge">Cupertino</code> widgets and <code class="highlighter-rouge">CustomScrollView</code>s at a later stage but for now just trust that it will work.</p>

<p>Finally, let’s now go to <code class="highlighter-rouge">main.dart</code> and add the following code:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// lib/main.dart</span>

<span class="n">import</span> <span class="err">'</span><span class="n">package</span><span class="p">:</span><span class="n">flutter</span><span class="p">/</span><span class="n">cupertino</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>
<span class="n">import</span> <span class="err">'</span><span class="n">package</span><span class="p">:</span><span class="n">flutter</span><span class="p">/</span><span class="n">material</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>
<span class="n">import</span> <span class="err">'</span><span class="n">package</span><span class="p">:</span><span class="n">flutter_bloc</span><span class="p">/</span><span class="n">flutter_bloc</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>

<span class="n">import</span> <span class="err">'</span><span class="n">repository</span><span class="p">/</span><span class="n">posts</span><span class="p">/</span><span class="n">post_repository</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>
<span class="n">import</span> <span class="err">'</span><span class="n">pages</span><span class="p">/</span><span class="n">posts_page</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>
<span class="n">import</span> <span class="err">'</span><span class="n">blocs</span><span class="p">/</span><span class="n">posts</span><span class="p">/</span><span class="n">post_bloc</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>
<span class="n">import</span> <span class="err">'</span><span class="n">blocs</span><span class="p">/</span><span class="n">posts</span><span class="p">/</span><span class="n">post_event</span><span class="p">.</span><span class="n">dart</span><span class="err">'</span><span class="p">;</span>

<span class="k">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">=&gt;</span> <span class="nf">runApp</span><span class="p">(</span><span class="nf">MyApp</span><span class="p">());</span>

<span class="k">class</span> <span class="nc">MyApp</span> <span class="n">extends</span> <span class="n">StatelessWidget</span> <span class="p">{</span>
  <span class="n">@override</span>
  <span class="n">Widget</span> <span class="nf">build</span><span class="p">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nf">CupertinoApp</span><span class="p">(</span>
      <span class="n">title</span><span class="p">:</span> <span class="err">'</span><span class="n">My</span> <span class="n">Posts</span><span class="err">'</span><span class="p">,</span>
      <span class="n">debugShowCheckedModeBanner</span><span class="p">:</span> <span class="k">false</span><span class="p">,</span>
      <span class="n">localizationsDelegates</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">DefaultMaterialLocalizations</span><span class="p">.</span><span class="k">delegate</span><span class="p">,</span>
        <span class="n">DefaultCupertinoLocalizations</span><span class="p">.</span><span class="k">delegate</span><span class="p">,</span>
        <span class="n">DefaultWidgetsLocalizations</span><span class="p">.</span><span class="k">delegate</span><span class="p">,</span>
      <span class="p">],</span>
      <span class="n">theme</span><span class="p">:</span> <span class="nf">CupertinoThemeData</span><span class="p">(</span>
        <span class="n">primaryColor</span><span class="p">:</span> <span class="n">Colors</span><span class="p">.</span><span class="n">purple</span>
      <span class="p">),</span>
      <span class="n">home</span><span class="p">:</span> <span class="n">BlocProvider</span><span class="p">&lt;</span><span class="n">PostsBloc</span><span class="p">&gt;(</span>
        <span class="n">create</span><span class="p">:</span> <span class="p">(</span><span class="n">context</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nf">PostsBloc</span><span class="p">(</span><span class="nf">HttpPostRepository</span><span class="p">())..</span><span class="k">add</span><span class="p">(</span><span class="nf">PostsPageLoaded</span><span class="p">()),</span>
        <span class="n">child</span><span class="p">:</span> <span class="nf">PostsPage</span><span class="p">(),</span>
      <span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p>We are done! Run your application and you will see a nice progress indicator showing while the <code class="highlighter-rouge">PostRepository</code> is still busy fetching posts from our REST API. When it’s done fetching the post it will display them in a list like the one below.</p>

<figure>
<img src="/images/flutter/posts.png" alt="Flutter app" />
<figcaption>App showing posts fetched using the http package</figcaption>
</figure>

<h2 id="conclusion">Conclusion</h2>

<p>In this post we spoke about how the <a href="https://pub.dev/packages/http">http</a> package can be used in Flutter to consume HTTP resources. We also created a sample Flutter app that makes use of the package to fetch posts from a REST API. Not all the code for the app was included in this post – you may check out the complete project from <a href="https://github.com/vince-nyanga/flutter_http_tutorial">GitHub</a>. Once again thanks so much for reading.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#flutter" class="page__taxonomy-item" rel="tag">Flutter</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#mobile" class="page__taxonomy-item" rel="tag">Mobile</a>
    
    </span>
  </p>




        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-02-15T00:00:00+02:00">February 15, 2020</time></p>
        
      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=Consuming+HTTP+Resources+In+Flutter%20http%3A%2F%2Flocalhost%3A4000%2Fconsuming-http-resources-in-flutter%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fconsuming-http-resources-in-flutter%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fconsuming-http-resources-in-flutter%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/flutter-widgets/" class="pagination--pager" title="Widgets: Building Blocks For Flutter Applications
">Previous</a>
    
    
      <a href="/working-with-forms-in-flutter/" class="pagination--pager" title="Working With Forms In Flutter
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/creating-uml-diagrams-made-easy/" rel="permalink">Creating UML Diagrams With Ease Using PlantText
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Unified Modeling Language (UML) has been around the software development circles for a fairly long time now. It helps provide a standardised way to visualise...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/building-resilient-applications-with-polly-part-2/" rel="permalink">Building Resilient .NET Core Applications With Polly’s Circuit Breaker Policy
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">In the previous post we introduced Polly, a .NET resilience and transient-fault-handling library. We spoke about the retry policy that can be used to help yo...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/building-resilient-applications-with-polly-part-1/" rel="permalink">Building Resilient .NET Core Applications With Polly’s Retry Policy
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">In this age of Service Oriented Architecture (SOA) where small microservices within a system communicate with each other using various protocols, typically o...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/facial-recognition-with-kairos/" rel="permalink">Facial Recognition In .NET With Kairos
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">A little over 2 years ago I worked on a project that involved facial recognition. Even though I eventually used Python for the project, I initially wanted to...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://www.linkedin.com/in/vincentnyanga/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://github.com/vince-nyanga/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Vincent Nyanga.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
